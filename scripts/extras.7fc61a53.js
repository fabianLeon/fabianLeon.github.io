"use strict";for(var params={},queryString=location.hash.substring(1),regex=/([^&=]+)=([^&]*)/g,m;m=regex.exec(queryString);)params[decodeURIComponent(m[1])]=decodeURIComponent(m[2]);var req=new XMLHttpRequest,query="https://"+window.location.host+"?"+queryString;req.open("GET",query,!0),req.onreadystatechange=function(a){console.log(a),4===req.readyState&&(200===req.status?window.location=params.state:400===req.status&&window.alert("There was an error processing the token."))},angular.module("estudiantesApp").factory("token_service",["$location","$http","$localStorage",function(a,b,c){var d={local:c.$default(params),header:null,token:null,live_token:function(){return"undefined"==typeof d.local.id_token||null===d.local.id_token?!1:(d.header=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(d.local.id_token.split(".")[0])),d.token=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(d.local.id_token.split(".")[1])),!0)},logout:function(){d.token=null,c.$reset(),window.location=a.absUrl()}};return d}]),angular.module("estudiantesApp").factory("notificacion",["$websocket",function(a){var b=a("ws://localhost:8080/register?id=2&profile=admin"),c=[];b.onMessage(function(a){c.unshift(JSON.parse(a.data))});var d={id:-1,log:c,get:function(){b.send(JSON.stringify({action:"get"}))},no_vistos:function(){var a=0;return angular.forEach(d.log,function(b){b.viewed||(a+=1)}),a}};return d}]),angular.module("estudiantesApp").controller("menuCtrl",["$location","$http","$scope","token_service","notificacion","$translate","$mdSidenav",function(a,b,c,d,e,f,g){function h(a){return function(){g(a).toggle()}}var i=[];c.language={es:"btn btn-primary btn-circle btn-outline active",en:"btn btn-primary btn-circle btn-outline"},c.notificacion=e,c.actual="",c.token_service=d,c.breadcrumb=[],c.menu_service=[{Id:2,Nombre:"Estudiantes",Url:"",Opciones:[{Id:3,Nombre:"Ver estudiantes",Url:"ver_estudiantes",Opciones:null},{Id:3,Nombre:"Editar estudiantes",Url:"editar_estudiantes",Opciones:null},{Id:3,Nombre:"Nuevo estudiante",Url:"nuevo_estudiante",Opciones:null}]},{Id:2,Nombre:"Materias",Url:"",Opciones:[{Id:3,Nombre:"Ver materias",Url:"ver_materias",Opciones:null},{Id:3,Nombre:"Editar materias",Url:"editar_materias",Opciones:null},{Id:3,Nombre:"Nueva materia",Url:"nueva_materia",Opciones:null}]},{Id:2,Nombre:"Inscripciones",Url:"",Opciones:[{Id:3,Nombre:"Inscribir Materias",Url:"inscribir_materia",Opciones:null}]}];var j=function(a,b){for(var c="",d=0;d<a.length;d++)null===a[d].Opciones?(c=b+" , "+a[d].Nombre,i.push({path:a[d].Url,padre:c.split(",")})):j(a[d].Opciones,b+","+a[d].Nombre);return c},k=function(){c.breadcrumb=[""];for(var a=0;a<i.length;a++)c.actual==="/"+i[a].path?c.breadcrumb=i[a].padre:"/"===c.actual&&(c.breadcrumb=[""])};j(c.menu_service,""),i.push({padre:["","Notificaciones","Ver Notificaciones"],path:"notificaciones"}),c.$on("$routeChangeStart",function(b,d){c.actual=a.path(),k(),console.log(b+d)}),c.changeLanguage=function(a){switch(f.use(a),a){case"es":c.language.es="btn btn-primary btn-circle btn-outline active",c.language.en="btn btn-primary btn-circle btn-outline";break;case"en":c.language.en="btn btn-primary btn-circle btn-outline active",c.language.es="btn btn-primary btn-circle btn-outline"}},function(a){a(document).ready(function(){a("ul.dropdown-menu [data-toggle=dropdown]").on("click",function(b){b.preventDefault(),b.stopPropagation(),a(this).parent().siblings().removeClass("open"),a(this).parent().toggleClass("open")})})}(jQuery),c.toggleLeft=h("left"),c.toggleRight=h("right")}]),angular.module("estudiantesApp").controller("footerCtrl",["$scope",function(a){a.enlaces_universitarios=[{nombre:"Transparencia",link:"#/"},{nombre:"Normatividad",link:"#/"},{nombre:"Trámites",link:"#/"},{nombre:"General",link:"#/"},{nombre:"Docente",link:"#/"},{nombre:"Académica Estudiantil ",link:"#/"},{nombre:"Derechos Pecuniarios",link:"#/"},{nombre:"Sistema de Notificaciones",link:"#/"},{nombre:"CSU",link:"#/"},{nombre:"PIGA",link:"#/"},{nombre:"Bitácora",link:"#/"},{nombre:"Noticias anterioresg",link:"#/"},{nombre:"Área de Red UDNet",link:"#/"},{nombre:"Administración PWI",link:"#/"}],a.copyright="© Copyright 1995 - 2017 - Todos los Derechos Reservados ...",a.map=[{nombre:"Preguntas Frecuentes",link:"#/"},{nombre:"Mapa del Porta",link:"#/"},{nombre:"Política de Privacidad",link:"#/"}]}]),angular.module("estudiantesApp").controller("NotificacionesCtrl",["$scope","notificacion",function(a,b){a.imagePath="images/yeoman.8cb970fb.png",a.notificacion=b}]);var text_es={TITULO:"GENERATOR-OAS",MENSAJE_INICIAL:"Ahora puede comenzar con el desarrollo ...",LISTADO_ESTUDIANTES:"Listado de estudiantes",VISTA_PREVIA_ESTUDIANTES:"Ver estudiante",EDITAR_ESTUDIANTES:"Editar estudiante",BTN:{NUEVO:"Nuevo",BORRAR:"Borrar",GUARDAR:"Guardar",ELIMINAR:"Eliminar",ACEPTAR:"Aceptar"},MATERIA:"Materia",DOCUMENTO:"Documento",NOMBRES_ESTUDIANTE:"Nombres del estudiante",APELLIDOS_ESTUDIANTE:"Apellidos del estudiante",ADICION_CANCELACION:"Adiciones y cancelaciones"},text_en={TITULO:"GENERATOR-OAS",MENSAJE_INICIAL:"Now get to start to develop ..."};angular.module("estudiantesApp").config(["$translateProvider",function(a){a.translations("es",text_es).translations("en",text_en),a.preferredLanguage("es"),a.useSanitizeValueStrategy("sanitizeParameters")}]),angular.module("estudiantesApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("estudiantesApp").controller("VerEstudiantesCtrl",["$scope","estudianteRequest",function(a,b){var c=this;c.vista_previa=!1,c.estudiante_actual=null,c.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Documento"},{field:"Nombre"},{field:"Apellido"}]},c.gridOptions.multiSelect=!1,b.get("estudiante","limit=0").then(function(a){c.gridOptions.data=a.data,console.log(c.gridOptions.data)}),c.gridOptions.onRegisterApi=function(b){c.gridApi=b,b.selection.on.rowSelectionChanged(a,function(a){c.estudiante_actual=a.entity,null!==c.estudiante_actual&&(c.vista_previa=!0)})},c.limpiar_seleccion=function(){c.vista_previa=null}}]),angular.module("estudiantesApp").controller("EditarEstudiantesCtrl",["estudianteRequest","$scope",function(a,b){var c=this;c.vista_previa=!1,c.estudiante_actual=null,c.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Documento"},{field:"Nombre"},{field:"Apellido"}]},c.gridOptions.multiSelect=!1;var d=function(){a.get("estudiante","limit=0").then(function(a){c.gridOptions.data=a.data,console.log(c.gridOptions.data)})};d(),c.gridOptions.onRegisterApi=function(a){c.gridApi=a,a.selection.on.rowSelectionChanged(b,function(a){c.estudiante_actual=a.entity,null!==c.estudiante_actual&&(c.vista_previa=!0)})},c.limpiar_seleccion=function(){c.vista_previa=null},c.guardar=function(){a.put("estudiante",c.estudiante_actual.Id,c.estudiante_actual).then(function(a){"OK"===a.data&&(d(),swal("Buen trabajo!","Se editó correctamente!","success"),c.limpiar_seleccion())})},c.eliminar=function(){swal({title:"Está seguro?",text:"No podrá revertir esto!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Eliminar"}).then(function(){a["delete"]("estudiante",c.estudiante_actual.Id).then(function(a){console.log(a),"OK"===a.data?(d(),c.limpiar_seleccion(),swal("Eliminado!","El estudiante ha sido eliminado.","success")):swal("No ha podido ser eliminado!",a.data,"error")})})}}]),angular.module("estudiantesApp").controller("VerMateriasCtrl",["$scope","estudianteRequest",function(a,b){var c=this;c.vista_previa=!1,c.materia_actual=null,c.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Tipo.Id",visible:!1},{field:"Nombre"},{field:"Tipo.Nombre",displayName:"Tipo de Materia"}]},c.gridOptions.multiSelect=!1,b.get("materia?related=Tipo&limit=0","").then(function(a){c.gridOptions.data=a.data,console.log(c.gridOptions.data)}),c.gridOptions.onRegisterApi=function(b){c.gridApi=b,b.selection.on.rowSelectionChanged(a,function(a){c.materia_actual=a.entity,null!==c.materia_actual&&(c.vista_previa=!0)})},c.limpiar_seleccion=function(){c.vista_previa=!c.vista_previa,c.materia_actual=null}}]),angular.module("estudiantesApp").controller("EditarMateriasCtrl",["$scope","estudianteRequest",function(a,b){var c=this;c.tipo_materia=null,c.vista_previa=!1,c.materia_actual=null,c.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Tipo.Id",visible:!1},{field:"Nombre"},{field:"Tipo.Nombre",displayName:"Tipo de Materia"}]},c.gridOptions.multiSelect=!1;var d=function(){b.get("materia",$.param({related:"Tipo",limit:0})).then(function(a){c.gridOptions.data=a.data,console.log(c.gridOptions.data)})};d();var e=function(){b.get("tipo_materia",$.param({limit:0})).then(function(a){c.tipo_materia=a.data})};e(),c.gridOptions.onRegisterApi=function(b){c.gridApi=b,b.selection.on.rowSelectionChanged(a,function(a){console.log(a.entity),c.materia_actual=a.entity,null!==c.materia_actual&&(c.vista_previa=!0)})},c.limpiar_seleccion=function(){d(),c.vista_previa=null,c.vista_previa=!1},c.anadir_tipo=function(){swal({title:"Ingrese el nuevo tipo",input:"text",showCancelButton:!0,confirmButtonText:"Submit",showLoaderOnConfirm:!0,preConfirm:function(a){return new Promise(function(c,d){b.post("tipo_materia",{Nombre:a}).then(function(a){console.log(a),setTimeout(function(){201===a.status?(e(),c()):d("No ha podido ingresarse el nuevo tipo")},1e3)})})},allowOutsideClick:!1}).then(function(a){swal({type:"success",title:"Tipo creado!",html:"El tipo "+a+" ha sido creado con éxito"})})},c.guardar=function(){b.put("materia",c.materia_actual.Id,c.materia_actual).then(function(a){"OK"===a.data&&(d(),swal("Buen trabajo!","Se editó correctamente!","success"),c.limpiar_seleccion())})},c.eliminar=function(){swal({title:"Está seguro?",text:"No podrá revertir esto!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Eliminar"}).then(function(){b["delete"]("materia",c.materia_actual.Id).then(function(a){"OK"===a.data?(d(),c.limpiar_seleccion(),swal("Eliminación !","La materia ha sido eliminada.","success")):swal("No ha podido ser eliminado!",a.data,"error")})})}}]),angular.module("estudiantesApp").controller("NuevoEstudianteCtrl",["estudianteRequest",function(a){var b=this;b.vista_previa=!1,b.nuevo_estudiante=null,b.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Documento"},{field:"Nombre"},{field:"Apellido"}]},b.gridOptions.multiSelect=!1;var c=function(){a.get("estudiante","limit=0").then(function(a){b.gridOptions.data=a.data,console.log(b.gridOptions.data)})};c(),b.gridOptions.onRegisterApi=function(a){b.gridApi=a},b.limpiar_seleccion=function(){b.vista_previa=!b.vista_previa,b.nuevo_estudiante=null},b.guardar=function(){a.post("estudiante",b.nuevo_estudiante).then(function(a){console.log(a),201===a.status&&(swal("Buen trabajo!","Añadió el estudiante con éxito","success"),b.limpiar_seleccion(),c())})}}]),angular.module("estudiantesApp").controller("NuevaMateriaCtrl",["estudianteRequest",function(a){var b=this;b.tipo_materia=null,b.vista_previa=!1,b.nueva_materia=null,b.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Tipo.Id",visible:!1},{field:"Nombre"},{field:"Tipo.Nombre",displayName:"Tipo de Materia"}]},b.gridOptions.multiSelect=!1;var c=function(){a.get("materia?related=Tipo&limit=0","").then(function(a){b.gridOptions.data=a.data,console.log(b.gridOptions.data)})};c();var d=function(){a.get("tipo_materia","limit=0").then(function(a){b.tipo_materia=a.data})};d(),b.gridOptions.onRegisterApi=function(a){b.gridApi=a},b.limpiar_seleccion=function(){c(),b.nueva_materia=null,b.vista_previa=!b.vista_previa},b.anadir_tipo=function(){swal({title:"Ingrese el nuevo tipo",input:"text",showCancelButton:!0,confirmButtonText:"Submit",showLoaderOnConfirm:!0,preConfirm:function(b){return new Promise(function(c,e){a.post("tipo_materia",{Nombre:b}).then(function(a){console.log(a),setTimeout(function(){201===a.status?(d(),c()):e("No ha podido ingresarse el nuevo tipo")},1e3)})})},allowOutsideClick:!1}).then(function(a){swal({type:"success",title:"Tipo creado!",html:"El tipo"+a+"ha sido creado con éxito"})})},b.guardar=function(){a.post("materia",b.nueva_materia).then(function(a){console.log(a),201===a.status&&(swal("Buen trabajo!","Añadió el estudiante con éxito","success"),b.limpiar_seleccion(),c())})},b.eliminar=function(){swal({title:"Está seguro?",text:"No podrá revertir esto!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Eliminar"}).then(function(){a["delete"]("estudiante",b.nueva_materia.Id).then(function(a){"OK"===a.data?(c(),b.limpiar_seleccion(),swal("Eliminado!","El estudiante ha sido eliminado.","success")):swal("No ha podido ser eliminado!",a.data,"error")})})}}]),angular.module("estudiantesApp").factory("estudianteRequest",["$http","CONF",function(a,b){return{get:function(c,d){var e=b.PATH_API_ESTUDIANTES+c+"?"+d;return a.get(e)},post:function(c,d){return a.post(b.PATH_API_ESTUDIANTES+c,d,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})},put:function(c,d,e){return a.put(b.PATH_API_ESTUDIANTES+c+"/"+d,e)},"delete":function(c,d){return a["delete"](b.PATH_API_ESTUDIANTES+c+"/"+d)}}}]),angular.module("estudiantesApp").constant("CONF",{PATH_API_ESTUDIANTES:"http://localhost:8080/v1/"}),angular.module("estudiantesApp").controller("InscribirMateriaCtrl",["estudianteRequest","$scope",function(a,b){var c=this;c.vista_previa=!1,c.mis_materias=[],c.materias=[],c.estudiante_actual=null,c.gridOptions={enableFiltering:!0,enableSorting:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"Id",visible:!1},{field:"Documento"},{field:"Nombre"},{field:"Apellido"}]},c.gridOptions.multiSelect=!1;var d=function(){a.get("estudiante","limit=0").then(function(a){c.gridOptions.data=a.data,console.log(c.gridOptions.data)})};d();var e=function(){c.mis_materias=[],a.get("estudiante_materia",$.param({query:"Estudiante.Id:"+c.estudiante_actual.Id,related:"Materia",limit:0})).then(function(a){c.mis_materias=a.data})},f=function(){c.materias=[],a.get("materia",$.param({related:"Tipo",limit:0})).then(function(a){angular.forEach(a.data,function(a){c.materias.push(a)})})};c.gridOptions.onRegisterApi=function(a){c.gridApi=a,a.selection.on.rowSelectionChanged(b,function(a){c.estudiante_actual=a.entity,null!==c.estudiante_actual&&(c.vista_previa=!0,e(),f())})},c.limpiar_seleccion=function(){c.vista_previa=null},c.guardar=function(){var b={Estudiante:c.estudiante_actual,Materia:c.materia_actual};a.post("estudiante_materia",b).then(function(a){201===a.status&&(d(),swal("Buen trabajo!","ha inscrito correctamente !","success"),c.limpiar_seleccion())})},c.cancelar_materia=function(b){console.log(b),swal({title:"Está seguro?",text:"No podrá volver a inscribir esta materia!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Eliminar"}).then(function(){a["delete"]("estudiante_materia",b.Id).then(function(a){"OK"===a.data?(d(),c.limpiar_seleccion(),swal("Materia Cancelada!","La materia ha sido cancelada con éxito.","success")):swal("No ha podido ser eliminado!",a.data,"error")})})}}]);